<% content_for :title do %>
  <% "Submissions" %>
<% end %>
<h2>Submissions</h2>
<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th>ID</th>
      <th>User</th>
      <th>Problem</th>
      <th>Status</th>
      <th>Time</th>
      <th>Memory</th>
      <th>Language</th>
      <th>Submit Time</th>
    </tr>
  </thead>
  <tbody>
    <% @submissions.each do |submission| %>
      <tr>
        <td><%= submission.id %></td>
        <td><%= link_to submission.user.handle, user_path(submission.user) %></td>
        <td><center><%= link_to submission.problem_id, problem_path(submission.problem_id) %></center></td>
        <td>
          <% status = OJ::StatusName[submission.status] %>
          <% if user_signed_in? && (current_user.has_role?(:admin) || submission.user_id == current_user.id) && status == "Compile Error" %>
            <%= link_to "Compile Error", submission_path(submission), :class => "btn btn-warning btn-mini" %>
          <% else %>
            <span class="label label-<%= get_submission_status(status) %>">
              <%= status %>
            </span>
          <% end %>
        </td>
        <td><%= "#{submission.time}ms" if submission.time %></td>
        <td><%= "#{submission.memory}KB" if submission.memory %></td>
        <td>
          <% language = OJ::LanguageName[submission.language] %>
          <% if user_signed_in? && (current_user.has_role?(:admin) || submission.user_id == current_user.id) %>
            <%= link_to language, submission_path(submission) %>
          <% else %>
            <%= language %>
          <% end %>
        </td>
        <td><%= submission.created_at.localtime.to_s(:db) %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<ul class="pager">
  <% if @current_page > 1 %>
    <li class="previous">
    <a href="<%= "?page=#{@current_page - 1}" %>">&larr; Previous</a>
    </li>
  <% end %>
  <% unless @submissions.empty? %>
    <li class="next">
    <a href="<%= "?page=#{@current_page + 1}" %>">Next &rarr;</a>
    </li>
  <% end %>
</ul>
